# Muonä¼˜åŒ–å™¨çš„åŸºæœ¬åŸç†ç ”ç©¶

## é—®é¢˜åˆ†æ

ä¼ ç»Ÿæ·±åº¦å­¦ä¹ ä¼˜åŒ–å™¨ï¼ˆå¦‚Adamã€SGDï¼‰åœ¨å¤„ç†ç¥ç»ç½‘ç»œå‚æ•°æ—¶ï¼Œé€šå¸¸å°†æƒé‡çŸ©é˜µè§†ä¸ºæ‰å¹³åŒ–çš„å‘é‡ï¼Œå¯¹æ¯ä¸ªå‚æ•°ç‹¬ç«‹åº”ç”¨è‡ªé€‚åº”å­¦ä¹ ç‡ã€‚è¿™ç§æ–¹æ³•å¿½ç•¥äº†ç¥ç»ç½‘ç»œä¸­æƒé‡å‚æ•°å›ºæœ‰çš„çŸ©é˜µç»“æ„ç‰¹æ€§ï¼Œå¯èƒ½å¯¼è‡´ä¼˜åŒ–è¿‡ç¨‹ä¸­çš„å‡ ä½•å¤±é…é—®é¢˜ã€‚éšç€å¤§æ¨¡å‹ï¼ˆå°¤å…¶æ˜¯å¤§å‹è¯­è¨€æ¨¡å‹ï¼‰è§„æ¨¡çš„ä¸æ–­æ‰©å±•ï¼Œå‚æ•°é—´çš„ç»“æ„ä¾èµ–å…³ç³»å˜å¾—æ›´åŠ å¤æ‚ï¼Œä¼ ç»Ÿä¼˜åŒ–æ–¹æ³•åœ¨è®­ç»ƒç¨³å®šæ€§ã€æ”¶æ•›é€Ÿåº¦å’Œå†…å­˜æ•ˆç‡æ–¹é¢é¢ä¸´æ˜¾è‘—æŒ‘æˆ˜ã€‚æœ¬ç ”ç©¶èšç„¦äºMuonä¼˜åŒ–å™¨è¿™ä¸€æ–°å…´ç®—æ³•ï¼Œæ¢ç©¶å…¶å¦‚ä½•é€šè¿‡æ˜¾å¼åˆ©ç”¨çŸ©é˜µå‡ ä½•ç»“æ„æ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚

## å…³é”®å‘ç°

### 1. çŸ©é˜µç»“æ„æ„ŸçŸ¥çš„æ ¸å¿ƒæ€æƒ³

Muonä¼˜åŒ–å™¨çš„æ ¹æœ¬åˆ›æ–°åœ¨äºå…¶**æ˜¾å¼åˆ©ç”¨æƒé‡å‚æ•°çš„çŸ©é˜µç»“æ„**ï¼Œè€Œéå°†å‚æ•°è§†ä¸ºç‹¬ç«‹çš„æ ‡é‡é›†åˆã€‚ä¸Adamç­‰ä¼ ç»Ÿä¸€é˜¶ä¼˜åŒ–å™¨ä¸åŒï¼ŒMuonç›´æ¥åœ¨çŸ©é˜µç©ºé—´ä¸­æ“ä½œï¼Œä¿æŒå‚æ•°é—´çš„å‡ ä½•å…³ç³»ï¼š

> "Unlike traditional first-order optimizers such as Adam, which treat neural network parameters as flattened vectors and maintain per-coordinate adaptivity, Muon directly exploits the matrix structure of weight parameters, uses spectral norm-based update rules, and implements a form of implicit regularization" [1]

è¿™ç§è®¾è®¡ä½¿Muonèƒ½å¤Ÿæ•æ‰å‚æ•°é—´çš„é«˜é˜¶ä¾èµ–å…³ç³»ï¼Œç‰¹åˆ«é€‚ç”¨äºç°ä»£æ·±åº¦å­¦ä¹ ä¸­æ™®éå­˜åœ¨çš„çŸ©é˜µå‚æ•°åŒ–ç»“æ„ï¼ˆå¦‚å…¨è¿æ¥å±‚ã€æ³¨æ„åŠ›æœºåˆ¶ä¸­çš„æƒé‡çŸ©é˜µï¼‰ã€‚

### 2. åŸºäºçŸ©é˜µèŒƒæ•°çš„å‡ ä½•æ›´æ–°æœºåˆ¶

Muonçš„æ ¸å¿ƒæ•°å­¦åŸç†åŸºäº**çŸ©é˜µèŒƒæ•°ç†è®º**ï¼Œç‰¹åˆ«æ˜¯è°±èŒƒæ•°(spectral norm)å’Œæ ¸èŒƒæ•°(nuclear norm)çš„åº”ç”¨ï¼š

- **è°±èŒƒæ•°æ§åˆ¶**ï¼šé€šè¿‡é™åˆ¶æƒé‡çŸ©é˜µçš„æœ€å¤§å¥‡å¼‚å€¼ï¼Œæœ‰æ•ˆæ§åˆ¶æ¨¡å‹çš„Lipschitzå¸¸æ•°ï¼Œä»è€Œæå‡è®­ç»ƒç¨³å®šæ€§
- **æ ¸èŒƒæ•°ä¼˜åŒ–**ï¼šä½œä¸ºLion-ğ’¦ä¼˜åŒ–å™¨å®¶æ—çš„ç‰¹ä¾‹ï¼ŒMuoné€‰æ‹©æ ¸èŒƒæ•°ä½œä¸ºå…¶å‡¸æ˜ å°„ï¼Œäº§ç”ŸçŸ©é˜µç»“æ„åŒ–çš„æ›´æ–°è§„åˆ™ [4]

å…¶æ ¸å¿ƒæ›´æ–°å…¬å¼å¯è¡¨ç¤ºä¸ºï¼š
```
Mt+1 = Î²â‚‚Mt - (1-Î²â‚‚)Gt
Pt+1 = Î²â‚Mt+1 - (1-Î²â‚)Gt
Xt+1 = Xt + Î·t(âˆ‡K(Pt+1) - Î»Xt+1)
```
å…¶ä¸­âˆ‡K(Pt+1)è¡¨ç¤ºæ ¸èŒƒæ•°çš„æ¬¡æ¢¯åº¦ï¼Œç­‰ä»·äºçŸ©é˜µç¬¦å·å‡½æ•°(sign function)ï¼Œè¿™ç¡®ä¿äº†æ›´æ–°è¿‡ç¨‹ä¿æŒçŸ©é˜µçš„å‡ ä½•ç‰¹æ€§ [4]ã€‚

### 3. éšå¼æ­£åˆ™åŒ–ä¸ç¨³å®šæ€§ä¿éšœ

Muoné€šè¿‡å…¶æ›´æ–°æœºåˆ¶å®ç°äº†**éšå¼æ­£åˆ™åŒ–**æ•ˆæœï¼Œä¸»è¦ä½“ç°åœ¨ï¼š

1. **å¥‡å¼‚å€¼çº¦æŸ**ï¼šä¼˜åŒ–è¿‡ç¨‹éšå¼é™åˆ¶äº†æƒé‡çŸ©é˜µçš„æœ€å¤§å¥‡å¼‚å€¼ï¼Œç›¸å½“äºå¯¹æ¨¡å‹çš„Lipschitzå¸¸æ•°æ–½åŠ çº¦æŸï¼Œè¿™ç›´æ¥å…³è”åˆ°æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œå¯¹æŠ—é²æ£’æ€§ [4]
   
2. **æœ€å°ä½œç”¨åŸç†**ï¼šè®¾è®¡å“²å­¦åŸºäº"æœ€å°æ‰°åŠ¨"åŸåˆ™â€”â€”æ¯æ¬¡æ›´æ–°åº”åœ¨æœ€å°åŒ–æ¨¡å‹ç»“æ„æ‰°åŠ¨çš„åŒæ—¶æœ€å¤§åŒ–æŸå¤±å‡å°‘ï¼š
   > "an ideal optimizer should possess two characteristics: stability and speed. Specifically, each update step of an ideal optimizer should: 1) minimize disturbance to the model, and 2) maximize contribution to loss reduction" [2]

3. **æ­£äº¤åŒ–æœºåˆ¶**ï¼šé€šè¿‡çŸ©é˜µæ­£äº¤åˆ†è§£æŠ€æœ¯ï¼Œç¡®ä¿æƒé‡æ›´æ–°ä¿æŒç‰¹å®šçš„å‡ ä½•å±æ€§ï¼Œé¿å…ä¼ ç»Ÿä¼˜åŒ–å™¨ä¸­å¸¸è§çš„æ¢¯åº¦æ–¹å‘å¤±é…é—®é¢˜ [3]

### 4. ä¸Lion-ğ’¦ä¼˜åŒ–å™¨å®¶æ—çš„ç†è®ºå…³è”

ç†è®ºç ”ç©¶è¡¨æ˜ï¼ŒMuonæ˜¯Lion-ğ’¦ä¼˜åŒ–å™¨æ¡†æ¶çš„ä¸€ä¸ªç‰¹ä¾‹ï¼š
> "Muon operates within the Lion-ğ’¦ family of optimizers by selecting the nuclear norm as its convex map, yielding a matrix-structured update" [1]

æ›´ç²¾ç¡®åœ°è¯´ï¼š
> "We show that the recently proposed Muon optimizer is an instance of the Lion- optimizer when equipped with the nuclear norm" [4]

è¿™ç§ç†è®ºå½’å±ä¸ºMuonæä¾›äº†åšå®çš„æ•°å­¦åŸºç¡€ï¼Œè¯æ˜å…¶è§£å†³çš„æ˜¯ä»¥ä¸‹çº¦æŸä¼˜åŒ–é—®é¢˜ï¼š
```
minimize L(W) subject to ||W||* â‰¤ C
```
å…¶ä¸­||W||*è¡¨ç¤ºæ ¸èŒƒæ•°ï¼ŒCä¸ºå¸¸æ•°çº¦æŸï¼Œè¿™è§£é‡Šäº†Muonä¸ºä½•èƒ½æœ‰æ•ˆæ§åˆ¶æ¨¡å‹å¤æ‚åº¦ã€‚

## æ•°æ®æ”¯æ’‘

### 1. æ”¶æ•›æ€§èƒ½å¯¹æ¯”

å®éªŒæ•°æ®æ˜¾ç¤ºï¼ŒMuonåœ¨å¤§å‹è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒä¸­å±•ç°å‡ºæ˜¾è‘—ä¼˜åŠ¿ï¼š
- åœ¨åŒç­‰æ¡ä»¶ä¸‹ï¼Œç›¸æ¯”AdamWï¼ŒMuonå®ç°äº†**æ›´å¿«çš„æ”¶æ•›é€Ÿåº¦**ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼è®­ç»ƒç¯å¢ƒä¸­ [1]
- å†…å­˜å¼€é”€é™ä½çº¦15-20%ï¼Œè¿™å½’åŠŸäºå…¶é¿å…äº†ä¼ ç»Ÿè‡ªé€‚åº”ä¼˜åŒ–å™¨ä¸­å­˜å‚¨äºŒé˜¶çŸ©ä¼°è®¡çš„éœ€æ±‚ [1]

### 2. ç¨³å®šæ€§é‡åŒ–åˆ†æ

é€šè¿‡ç†è®ºæ¨å¯¼å¯è¯æ˜Muonçš„ç¨³å®šæ€§ä¿è¯ï¼š
```
||W_t|| â‰¤ max(||W_{t-1}||, ||O_t/Î»||)
```
å…¶ä¸­O_tä¸ºæ›´æ–°æ–¹å‘ï¼ŒÎ»ä¸ºæƒé‡è¡°å‡ç³»æ•°ã€‚æ­¤ä¸ç­‰å¼è¡¨æ˜æƒé‡èŒƒæ•°è¢«æœ‰æ•ˆçº¦æŸï¼Œé˜²æ­¢äº†è®­ç»ƒè¿‡ç¨‹ä¸­çš„çˆ†ç‚¸æ€§å¢é•¿ [2]ã€‚

### 3. å¥‡å¼‚å€¼åˆ†å¸ƒæ§åˆ¶

å®è¯ç ”ç©¶è¡¨æ˜ï¼Œä½¿ç”¨Muonè®­ç»ƒçš„æ¨¡å‹ï¼Œå…¶æƒé‡çŸ©é˜µçš„å¥‡å¼‚å€¼åˆ†å¸ƒæ›´åŠ é›†ä¸­ï¼š
- æœ€å¤§å¥‡å¼‚å€¼è¢«æœ‰æ•ˆé™åˆ¶åœ¨åˆç†èŒƒå›´å†…
- å¥‡å¼‚å€¼è¡°å‡æ›²çº¿æ›´åŠ å¹³æ»‘ï¼Œè¡¨æ˜æ¨¡å‹å­¦ä¹ åˆ°äº†æ›´ç»“æ„åŒ–çš„è¡¨ç¤º [4]

## ç»“è®ºæ€»ç»“

Muonä¼˜åŒ–å™¨ä»£è¡¨äº†æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•è®¾è®¡èŒƒå¼çš„è½¬å˜â€”â€”ä»æ ‡é‡çº§è‡ªé€‚åº”åˆ°çŸ©é˜µçº§å‡ ä½•æ„ŸçŸ¥ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºï¼š

1. **ç»“æ„åŒ–ä¼˜åŒ–**ï¼šé€šè¿‡æ˜¾å¼åˆ©ç”¨æƒé‡çŸ©é˜µçš„å‡ ä½•ç»“æ„ï¼Œè§£å†³äº†ä¼ ç»Ÿä¼˜åŒ–å™¨å¿½ç•¥å‚æ•°é—´ä¾èµ–å…³ç³»çš„æ ¹æœ¬ç¼ºé™·

2. **ç†è®ºä¿éšœ**ï¼šåŸºäºLion-ğ’¦æ¡†æ¶å’ŒçŸ©é˜µèŒƒæ•°ç†è®ºï¼Œæä¾›äº†æ”¶æ•›æ€§å’Œç¨³å®šæ€§è¯æ˜ï¼Œç‰¹åˆ«æ˜¯å¯¹æƒé‡çŸ©é˜µå¥‡å¼‚å€¼çš„æœ‰æ•ˆçº¦æŸ

3. **å®ç”¨ä¼˜åŠ¿**ï¼šåœ¨å¤§å‹è¯­è¨€æ¨¡å‹è®­ç»ƒä¸­å±•ç°å‡ºæ›´å¿«çš„æ”¶æ•›é€Ÿåº¦ã€æ›´å¥½çš„ç¨³å®šæ€§ä»¥åŠæ›´ä½çš„å†…å­˜å¼€é”€ï¼ŒåŒæ—¶å‡å°‘äº†å¯¹ç²¾ç»†è¶…å‚æ•°è°ƒæ•´çš„ä¾èµ–

4. **æ‰©å±•æ½œåŠ›**ï¼šä½œä¸ºçŸ©é˜µä¼˜åŒ–æ¡†æ¶ï¼Œä¸ºæœªæ¥é’ˆå¯¹ç‰¹å®šæ¨¡å‹ç»“æ„ï¼ˆå¦‚Transformerä¸­çš„æ³¨æ„åŠ›çŸ©é˜µï¼‰è®¾è®¡ä¸“ç”¨ä¼˜åŒ–å™¨æä¾›äº†ç†è®ºåŸºç¡€

å°½ç®¡Muonåœ¨ç†è®ºä¸Šå…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ï¼Œä½†å…¶è®¡ç®—å¤æ‚åº¦ç•¥é«˜äºä¼ ç»Ÿä¸€é˜¶æ–¹æ³•ï¼ˆä¸»è¦æ¥è‡ªçŸ©é˜µç¬¦å·å‡½æ•°çš„è®¡ç®—ï¼‰ï¼Œè¿™åœ¨è¶…å¤§è§„æ¨¡æ¨¡å‹è®­ç»ƒä¸­å¯èƒ½éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚æ€»ä½“è€Œè¨€ï¼ŒMuonä»£è¡¨äº†ä¼˜åŒ–å™¨è®¾è®¡ä»"å‘é‡æ€ç»´"åˆ°"çŸ©é˜µæ€ç»´"çš„é‡è¦æ¼”è¿›ï¼Œä¸ºä¸‹ä¸€ä»£æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•æŒ‡æ˜äº†æ–¹å‘ã€‚

## å‚è€ƒèµ„æ–™

[1] Emergent Mind. "Muon Optimizer: Matrix-Aware Learning". https://www.emergentmind.com/topics/muon-optimizer

[2] Kimi.ai. "Why We Chose Muon: Our Chain of Thought". https://x.com/Kimi_Moonshot/status/1897929976948965870

[3] Kyeg. "Building the Muon Optimizer in PyTorch: A Geometric Approach to Neural Network Optimization". https://medium.com/@kyeg/building-the-muon-optimizer-in-pytorch-a-geometric-approach-to-neural-network-optimization-17f4601be548

[4] UT Computer Science. "Muon is a Nuclear Lion King". https://www.cs.utexas.edu/~lqiang/lionk/html/intro.html

[5] arXiv. "AdaMuon: Adaptive Muon Optimizer". https://arxiv.org/html/2507.11005v1

[6] Medium. "Understanding the Muon Optimizer: A Game-Changer for Large Language Model Training". https://jehillparikh.medium.com/understanding-the-muon-optimizer-a-game-changer-for-large-language-model-training-15316975f0bc

## å‚è€ƒèµ„æ–™

[1] Muon Optimizer: Matrix-Aware Learning - Emergent Mind - https://www.emergentmind.com/topics/muon-optimizer
[2] Kimi.ai on X: "Why We Chose Muon: Our Chain of Thought" / X - Twitter - https://x.com/Kimi_Moonshot/status/1897929976948965870
[3] Building the Muon Optimizer in PyTorch: A Geometric Approach to ... - https://medium.com/@kyeg/building-the-muon-optimizer-in-pytorch-a-geometric-approach-to-neural-network-optimization-17f4601be548
[4] Muon Optimizer: Matrix-Aware Learning - Emergent Mind - https://www.emergentmind.com/topics/muon-optimizer
[5] AdaMuon: Adaptive Muon Optimizer - arXiv - https://arxiv.org/html/2507.11005v1
[6] Understanding the Muon Optimizer: A Game-Changer for Large ... - https://jehillparikh.medium.com/understanding-the-muon-optimizer-a-game-changer-for-large-language-model-training-15316975f0bc
[7] Muon is a Nuclear Lion King - UT Computer Science - https://www.cs.utexas.edu/~lqiang/lionk/html/intro.html